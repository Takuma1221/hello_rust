# å¤©æ°—äºˆå ±ãƒ¡ãƒ¢ã‚¢ãƒ—ãƒª ä»•æ§˜æ›¸

## ğŸ¯ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ¦‚è¦

**åå‰**: WeatherMemo  
**ç›®çš„**: è‡ªç„¶è¨€èªã§å¤©æ°—ã‚’èã„ã¦ã€è¨˜éŒ²ã‚’ JSON ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¿å­˜ã™ã‚‹ CLI ã‚¢ãƒ—ãƒª  
**æ¨å®šæ™‚é–“**: 2-3 æ™‚é–“  
**å­¦ç¿’ç›®æ¨™**:

- å¤–éƒ¨ Web API é€£æºï¼ˆOpenWeatherMapï¼‰
- ãƒ•ã‚¡ã‚¤ãƒ« I/O ã¨ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–
- è¤‡æ•°ã®å¼•æ•°å‹ã‚’æ‰±ã†ãƒ„ãƒ¼ãƒ«è¨­è¨ˆ

---

## ğŸ“‹ æ©Ÿèƒ½ä¸€è¦§

### 1. å¤©æ°—å–å¾—ï¼ˆAPI é€£æºï¼‰

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: æ±äº¬ã®å¤©æ°—ã‚’æ•™ãˆã¦
AI: å®Ÿè¡Œ: fetch_weather("æ±äº¬")
    æ±äº¬ã®å¤©æ°—: æ™´ã‚Œã€æ°—æ¸© 22â„ƒã€æ¹¿åº¦ 60%
```

### 2. å¤©æ°—ãƒ¡ãƒ¢ä¿å­˜ï¼ˆãƒ•ã‚¡ã‚¤ãƒ« I/Oï¼‰

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: ä»Šã®æ±äº¬ã®å¤©æ°—ã‚’ãƒ¡ãƒ¢ã—ã¦
AI: å®Ÿè¡Œ: fetch_weather("æ±äº¬")
    å®Ÿè¡Œ: save_weather_memo("æ±äº¬", "æ™´ã‚Œ", 22.0, "æ•£æ­©æ—¥å’Œ")
    ãƒ¡ãƒ¢ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼
```

### 3. ãƒ¡ãƒ¢ä¸€è¦§è¡¨ç¤º

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: éå»ã®ãƒ¡ãƒ¢ã‚’è¦‹ã›ã¦
AI: å®Ÿè¡Œ: list_memos()
    ã€ä¿å­˜æ¸ˆã¿ãƒ¡ãƒ¢ã€‘
    1. 2025-10-05 14:30 | æ±äº¬ | æ™´ã‚Œ 22â„ƒ | æ•£æ­©æ—¥å’Œ
    2. 2025-10-04 09:15 | å¤§é˜ª | æ›‡ã‚Š 19â„ƒ | è‚Œå¯’ã„
```

### 4. ç‰¹å®šéƒ½å¸‚ã®ãƒ¡ãƒ¢æ¤œç´¢

```
ãƒ¦ãƒ¼ã‚¶ãƒ¼: æ±äº¬ã®ãƒ¡ãƒ¢ã ã‘è¦‹ã›ã¦
AI: å®Ÿè¡Œ: search_memos("æ±äº¬")
    ã€æ±äº¬ã®ãƒ¡ãƒ¢ã€‘
    1. 2025-10-05 14:30 | æ™´ã‚Œ 22â„ƒ | æ•£æ­©æ—¥å’Œ
```

---

## ğŸ› ï¸ ä½¿ç”¨ã™ã‚‹ãƒ„ãƒ¼ãƒ«é–¢æ•°

### ãƒ„ãƒ¼ãƒ« 1: `fetch_weather`

```rust
async fn fetch_weather(city: String) -> Result<WeatherInfo, Error>
```

- **å½¹å‰²**: OpenWeatherMap API ã§ç¾åœ¨ã®å¤©æ°—å–å¾—
- **å¼•æ•°**: `city` (éƒ½å¸‚å: æ—¥æœ¬èª or è‹±èª)
- **è¿”å€¤**: å¤©æ°—ãƒ»æ°—æ¸©ãƒ»æ¹¿åº¦

### ãƒ„ãƒ¼ãƒ« 2: `save_weather_memo`

```rust
fn save_weather_memo(
    city: String,
    weather: String,
    temperature: f64,
    note: String
) -> Result<String, Error>
```

- **å½¹å‰²**: å¤©æ°—æƒ…å ± + ãƒ¦ãƒ¼ã‚¶ãƒ¼ãƒ¡ãƒ¢ã‚’ JSON ã«ä¿å­˜
- **å¼•æ•°**: éƒ½å¸‚åã€å¤©æ°—ã€æ°—æ¸©ã€ãƒ¡ãƒ¢
- **è¿”å€¤**: æˆåŠŸãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

### ãƒ„ãƒ¼ãƒ« 3: `list_memos`

```rust
fn list_memos() -> Result<String, Error>
```

- **å½¹å‰²**: å…¨ãƒ¡ãƒ¢ã‚’æ–°ã—ã„é †ã«è¡¨ç¤º
- **å¼•æ•°**: ãªã—
- **è¿”å€¤**: æ•´å½¢æ¸ˆã¿ãƒ†ã‚­ã‚¹ãƒˆ

### ãƒ„ãƒ¼ãƒ« 4: `search_memos`

```rust
fn search_memos(city: String) -> Result<String, Error>
```

- **å½¹å‰²**: ç‰¹å®šéƒ½å¸‚ã®ãƒ¡ãƒ¢ã ã‘æŠ½å‡º
- **å¼•æ•°**: `city` (éƒ½å¸‚å)
- **è¿”å€¤**: æ•´å½¢æ¸ˆã¿ãƒ†ã‚­ã‚¹ãƒˆ

---

## ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«æ§‹æˆ

```
src/
â”œâ”€â”€ main.rs                      # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”œâ”€â”€ function_call/               # æ—¢å­˜ã®è¨ˆç®—ãƒ„ãƒ¼ãƒ«
â”‚   â”œâ”€â”€ api.rs
â”‚   â”œâ”€â”€ errors.rs
â”‚   â”œâ”€â”€ play.rs
â”‚   â”œâ”€â”€ tools.rs
â”‚   â””â”€â”€ types.rs
â””â”€â”€ weather/                     # æ–°è¦: å¤©æ°—ã‚¢ãƒ—ãƒª
    â”œâ”€â”€ mod.rs                   # ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å®£è¨€
    â”œâ”€â”€ types.rs                 # ãƒ‡ãƒ¼ã‚¿å‹å®šç¾©
    â”œâ”€â”€ api.rs                   # OpenWeatherMap é€£æº
    â”œâ”€â”€ storage.rs               # JSON ãƒ•ã‚¡ã‚¤ãƒ« I/O
    â”œâ”€â”€ tools.rs                 # ãƒ„ãƒ¼ãƒ«å®Ÿè£…
    â””â”€â”€ play.rs                  # ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—

data/
â””â”€â”€ weather_memos.json           # ä¿å­˜ãƒ‡ãƒ¼ã‚¿ï¼ˆè‡ªå‹•ç”Ÿæˆï¼‰

.env
OPENAI_API_KEY=sk-...
OPENWEATHER_API_KEY=...          # æ–°è¦è¿½åŠ 
```

---

## ğŸ—‚ï¸ ãƒ‡ãƒ¼ã‚¿æ§‹é€ 

### WeatherInfoï¼ˆAPI ãƒ¬ã‚¹ãƒãƒ³ã‚¹ï¼‰

```rust
#[derive(Debug, Deserialize)]
pub struct WeatherInfo {
    pub city: String,
    pub weather: String,      // "æ™´ã‚Œ", "æ›‡ã‚Š", etc.
    pub temperature: f64,     // æ‘‚æ°
    pub humidity: u32,        // æ¹¿åº¦ %
}
```

### SavedMemoï¼ˆä¿å­˜ç”¨ï¼‰

```rust
#[derive(Debug, Serialize, Deserialize)]
pub struct SavedMemo {
    pub timestamp: String,    // ISO8601 å½¢å¼
    pub city: String,
    pub weather: String,
    pub temperature: f64,
    pub note: String,         // ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ¡ãƒ¢
}
```

### MemoStorageï¼ˆãƒ•ã‚¡ã‚¤ãƒ«å…¨ä½“ï¼‰

```rust
#[derive(Debug, Serialize, Deserialize)]
pub struct MemoStorage {
    pub memos: Vec<SavedMemo>,
}
```

---

## ğŸ”‘ å¿…è¦ãªæº–å‚™

### 1. OpenWeatherMap API ã‚­ãƒ¼å–å¾—

1. https://openweathermap.org/ ã§ã‚¢ã‚«ã‚¦ãƒ³ãƒˆä½œæˆï¼ˆç„¡æ–™ï¼‰
2. API Keys ã‹ã‚‰å–å¾—
3. `.env` ã«è¿½åŠ :

```bash
OPENWEATHER_API_KEY=your_key_here
```

### 2. ä¾å­˜ã‚¯ãƒ¬ãƒ¼ãƒˆè¿½åŠ 

```toml
[dependencies]
# æ—¢å­˜
tokio = { version = "1", features = ["full"] }
reqwest = { version = "0.11", features = ["json"] }
serde = { version = "1", features = ["derive"] }
serde_json = "1"
dotenv = "0.15"

# æ–°è¦è¿½åŠ 
chrono = { version = "0.4", features = ["serde"] }  # æ—¥æ™‚å‡¦ç†
```

---

## ğŸš€ å®Ÿè£…ã‚¹ãƒ†ãƒƒãƒ—

### Phase 1: ãƒ‡ãƒ¼ã‚¿å‹å®šç¾©ï¼ˆ15 åˆ†ï¼‰

- `weather/types.rs` ã§æ§‹é€ ä½“å®šç¾©
- serde ã® Serialize/Deserialize å°å…¥

### Phase 2: ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸å®Ÿè£…ï¼ˆ30 åˆ†ï¼‰

- `weather/storage.rs` ã§ JSON èª­ã¿æ›¸ã
- ãƒ•ã‚¡ã‚¤ãƒ«ãŒãªã„å ´åˆã®åˆæœŸåŒ–å‡¦ç†

### Phase 3: å¤©æ°— API å®Ÿè£…ï¼ˆ30 åˆ†ï¼‰

- `weather/api.rs` ã§ OpenWeatherMap å‘¼ã³å‡ºã—
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ï¼ˆéƒ½å¸‚åä¸æ˜ã€API ã‚¨ãƒ©ãƒ¼ï¼‰

### Phase 4: ãƒ„ãƒ¼ãƒ«å®Ÿè£…ï¼ˆ45 åˆ†ï¼‰

- `weather/tools.rs` ã§ 4 ã¤ã®ãƒ„ãƒ¼ãƒ«é–¢æ•°
- å¼•æ•°ãƒ‘ãƒ¼ã‚¹ç”¨ã®æ§‹é€ ä½“å®šç¾©

### Phase 5: ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—ï¼ˆ30 åˆ†ï¼‰

- `weather/play.rs` ã§ OpenAI é€£æº
- ãƒ„ãƒ¼ãƒ« schema å®šç¾©
- ãƒ«ãƒ¼ãƒ—å‡¦ç†

### Phase 6: ãƒ†ã‚¹ãƒˆï¼ˆ15 åˆ†ï¼‰

- å„æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª
- ã‚¨ãƒ©ãƒ¼ã‚±ãƒ¼ã‚¹ã®ç¢ºèª

---

## ğŸ“ ã‚µãƒ³ãƒ—ãƒ«ä¼šè©±ãƒ•ãƒ­ãƒ¼

```
$ cargo run --bin weather_app

å¤©æ°—ã‚¢ãƒ—ãƒªã‚’èµ·å‹•ã—ã¾ã—ãŸï¼ä½•ã‚’ã—ã¾ã—ã‚‡ã†ã‹ï¼Ÿ
> æ±äº¬ã®ä»Šæ—¥ã®å¤©æ°—ã¯ï¼Ÿ

å®Ÿè¡Œ: fetch_weather("æ±äº¬")
æ±äº¬ã®å¤©æ°—: æ™´ã‚Œã€æ°—æ¸© 22.5â„ƒã€æ¹¿åº¦ 58%

> ã“ã‚Œã‚’ãƒ¡ãƒ¢ã—ã¦ã€Œå…¬åœ’æ•£æ­©ã«æœ€é©ã€ã£ã¦è¿½åŠ ã§

å®Ÿè¡Œ: save_weather_memo("æ±äº¬", "æ™´ã‚Œ", 22.5, "å…¬åœ’æ•£æ­©ã«æœ€é©")
ãƒ¡ãƒ¢ã‚’ä¿å­˜ã—ã¾ã—ãŸï¼

> ãƒ¡ãƒ¢ä¸€è¦§ã‚’è¦‹ã›ã¦

å®Ÿè¡Œ: list_memos()
ã€ä¿å­˜æ¸ˆã¿ãƒ¡ãƒ¢ã€‘
1. 2025-10-05 15:30 | æ±äº¬ | æ™´ã‚Œ 22.5â„ƒ | å…¬åœ’æ•£æ­©ã«æœ€é©
```

---

## ğŸ“ å­¦ç¿’ãƒã‚¤ãƒ³ãƒˆ

### Web API é€£æº

- `reqwest::get()` ã§ HTTP ãƒªã‚¯ã‚¨ã‚¹ãƒˆ
- ã‚¯ã‚¨ãƒªãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã®æ§‹ç¯‰
- JSON ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®ãƒ‡ã‚·ãƒªã‚¢ãƒ©ã‚¤ã‚º

### ãƒ•ã‚¡ã‚¤ãƒ« I/O

- `std::fs::read_to_string()` / `write()`
- ãƒ•ã‚¡ã‚¤ãƒ«å­˜åœ¨ç¢ºèª (`Path::exists()`)
- ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªä½œæˆ (`create_dir_all()`)

### ãƒ‡ãƒ¼ã‚¿æ°¸ç¶šåŒ–

- serde_json ã§æ§‹é€ ä½“ â†” JSON
- è¿½è¨˜ãƒ­ã‚¸ãƒƒã‚¯ï¼ˆæ—¢å­˜é…åˆ—ã« pushï¼‰
- ã‚¿ã‚¤ãƒ ã‚¹ã‚¿ãƒ³ãƒ—ç”Ÿæˆï¼ˆchronoï¼‰

### è¤‡æ•°å¼•æ•°å‹

- String, f64, u32 ã‚’æ··åœ¨
- å„ãƒ„ãƒ¼ãƒ«ç”¨ã®å¼•æ•°æ§‹é€ ä½“è¨­è¨ˆ
- enum ã§è¤‡æ•°ãƒ‘ã‚¿ãƒ¼ãƒ³å¯¾å¿œ

---

## ğŸ”§ æ‹¡å¼µã‚¢ã‚¤ãƒ‡ã‚¢ï¼ˆä½™è£•ãŒã‚ã‚Œã°ï¼‰

- [ ] é€±é–“äºˆå ±å–å¾—
- [ ] ã‚°ãƒ©ãƒ•åŒ–ï¼ˆæ°—æ¸©ã®æ¨ç§»ï¼‰
- [ ] é€šçŸ¥æ©Ÿèƒ½ï¼ˆé›¨ãªã‚‰å‚˜ææ¡ˆï¼‰
- [ ] ä»–ã®éƒ½å¸‚ã¨æ¯”è¼ƒ
- [ ] CSV ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ

---

æº–å‚™ãŒã§ããŸã‚‰å®Ÿè£…ã‚’é–‹å§‹ã—ã¾ã—ã‚‡ã†ï¼ğŸ‘¨â€ğŸ’»
